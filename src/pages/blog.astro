---
import { getCollection } from 'astro:content'
import BaseLayout from '../layouts/BaseLayout.astro'
import BlogPost from '../components/BlogPost.astro'

const pageTitle = 'My Astro Learning Blog'
const publishsedPost = await getCollection(
    'posts',
    ({ data }) => data.draft !== true
)
---

<BaseLayout pageTitle={pageTitle}>
    <p>This is where I will post about my journey learning Astro.</p>
    <ul>
        {
            publishsedPost.map((post) => (
                <li>
                    <BlogPost
                        href={'/posts/' + post.slug}
                        title={post.data.title}
                        date={post.data.pubDate.toDateString()}
                        auth={post.data.author.id
                            .split('-')
                            .map(
                                (part) =>
                                    part.charAt(0).toUpperCase() + part.slice(1)
                            )
                            .join(' ')}
                    />
                </li>
            ))
        }
    </ul>
</BaseLayout>
