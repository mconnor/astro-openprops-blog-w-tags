---
import BaseLayout from '@layouts/BaseLayout.astro'
import { getCollection } from 'astro:content'
import TagContainer from '@components/TagContainer.astro'

const allPosts = await getCollection('posts')

const tagCounts: Record<string, number> = {}

allPosts.forEach((post) =>
    (post.data.tags || []).forEach((tag: string) => {
        tagCounts[tag] = (tagCounts[tag] || 0) + 1
    }),
)

const tags = [...new Set(allPosts.map((post) => post.data.tags).flat())]

// const tags = Object.keys(tagCounts)
---

<BaseLayout pageTitle="Tag Index" surfaceClass="surface-1">
    <TagContainer tags={tags} />
</BaseLayout>

<style>
    .block-wrap {
        max-inline-size: 80%;
    }
</style>
