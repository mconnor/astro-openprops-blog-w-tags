---
import { format } from 'date-fns';
import { getEntry } from 'astro:content';
import BaseLayout from '@layouts/BaseLayout.astro';

import { Box, Stack } from '@cc/index.js';
import TagContainer from '@components/TagContainer.astro';

interface Props {
  description: string;
  title: string;
  children: HTMLElement[];
  authorId: string;
  pubDate: Date;
  tags: string[];
}

const props = Astro.props;

const { title, description, authorId, pubDate, tags } = props;

// const { title, description, pubDate, author } = entry.data

const authorDataObj = await getEntry('authors', authorId);
---

<!-- TODO: fix the date format -->
<BaseLayout pageTitle={title} description={description}>
  <Stack>
    <Box padding="0" borderWidth="0">
      <Box><h2>{description}</h2></Box>
      <Box><slot name="banner" /></Box>

      {
        authorDataObj?.data.name && (
          <Box>
            <p>
              Written by: {authorDataObj.data.name},{' '}
              {format(pubDate, 'd MMM, yyyy')}
            </p>
          </Box>
        )
      }
    </Box>

    <TagContainer tags={tags} />
    <Box padding="0" borderWidth="0"><slot name="main" /> </Box>
  </Stack>
</BaseLayout>

<style></style>
